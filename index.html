<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KCISLK Learning Portfolio System (Final Fix)</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "firebase/app": "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js",
        "firebase/firestore": "https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore.js",
        "firebase/auth": "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js",
        "lucide-react": "https://esm.sh/lucide-react@0.344.0"
      }
    }
    </script>
    <style>
        body {
            font-family: "Microsoft JhengHei", "Inter", sans-serif;
            background-color: #FDFDFD;
        }

        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }

        .custom-scrollbar::-webkit-scrollbar-track {
            background: #f1f5f9;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }

        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .animate-in {
            animation: fadeIn 0.3s ease-out forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.95);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }
    </style>
</head>

<body>
    <div id="root"></div>

    <script type="module">
        import React, { useState, useMemo, useEffect, useRef } from 'react';
        import { createRoot } from 'react-dom/client';
        import { initializeApp } from 'firebase/app';
        import { getFirestore, doc, setDoc, onSnapshot, collection, getDoc } from 'firebase/firestore';
        import { getAuth, signInAnonymously, onAuthStateChanged } from 'firebase/auth';
        import {
            CheckCircle2, AlertTriangle, Clock, Search, ChevronDown, ChevronRight, Download, Settings2, Trash2,
            Plus, Check, AlertCircle, Loader2, ClipboardList, X, Save, GraduationCap, Users,
            ShieldCheck, FileSpreadsheet, Settings, Cloud, Award, FileJson, Upload, UserPlus, Zap,
            CheckSquare, Square, BarChart3, PieChart, BookOpen
        } from 'lucide-react';

        // --- 元件開始 ---
        const App = () => {
            const CLASSES = ['01', '02'];
            const DEFAULT_SUBJECTS = ['國文', '英文', '數學', '物理', '化學', '生物', '歷史', '地理', '公民', '資訊', '自然探究', '社會探究'];
            const DEFAULT_DIVERSE_TYPES = ['幹部經歷暨事蹟', '競賽參與', '檢定證照', '服務學習', '彈性學習時間', '團體活動時間', '職場學習', '作品成果', '大學及技專先修課程', '其他活動'];

            // 狀態定義
            const [firebaseInitialized, setFirebaseInitialized] = useState(false);
            const [showConfigModal, setShowConfigModal] = useState(false);
            const [configInput, setConfigInput] = useState('');

            const [db, setDb] = useState(null);
            const [user, setUser] = useState(null);

            const [semesters, setSemesters] = useState(['114-1', '114-2', '115-1', '115-2', '116-1', '116-2']);
            const [subjects, setSubjects] = useState(DEFAULT_SUBJECTS);
            const [diverseTypes, setDiverseTypes] = useState(DEFAULT_DIVERSE_TYPES);
            const [currentSemester, setCurrentSemester] = useState('114-1');
            const [currentClass, setCurrentClass] = useState('01');
            const [isManageMode, setIsManageMode] = useState(false);
            const [isImportModalOpen, setIsImportModalOpen] = useState(false);
            const [isSemModalOpen, setIsSemModalOpen] = useState(false);
            const [isBackupModalOpen, setIsBackupModalOpen] = useState(false);
            const [isStatsModalOpen, setIsStatsModalOpen] = useState(false);
            const [importText, setImportText] = useState('');
            const [newSemInput, setNewSemInput] = useState('');
            const [searchTerm, setSearchTerm] = useState('');
            const [expandedStudent, setExpandedStudent] = useState(null);
            const [loading, setLoading] = useState(false);
            const [isSaving, setIsSaving] = useState(false);
            const [allData, setAllData] = useState({});
            const fileInputRef = useRef(null);

            const isSecondSemester = useMemo(() => currentSemester.endsWith('-2'), [currentSemester]);

            // Click Outside to Collapse
            useEffect(() => {
                const handleClickOutside = (e) => {
                    if (!expandedStudent) return;
                    // Don't close if clicking inside the detail view
                    if (e.target.closest('.expanded-detail-row')) return;
                    // Don't close if clicking a student row (let the row's own handler manage the toggle)
                    if (e.target.closest('.student-summary-row')) return;

                    setExpandedStudent(null);
                };
                document.addEventListener('click', handleClickOutside);
                return () => document.removeEventListener('click', handleClickOutside);
            }, [expandedStudent]);

            // 1. 初始化 Firebase
            useEffect(() => {
                const storedConfig = localStorage.getItem('kcis_firebase_config');
                if (storedConfig) {
                    try {
                        const config = JSON.parse(storedConfig);
                        initFirebase(config);
                    } catch (e) {
                        console.error("Config Parse Error", e);
                        setShowConfigModal(true);
                    }
                } else {
                    setShowConfigModal(true);
                }
            }, []);

            const initFirebase = async (config) => {
                try {
                    // 防止重複初始化
                    if (window.firebaseApp) return;

                    const app = initializeApp(config);
                    window.firebaseApp = app;
                    const auth = getAuth(app);
                    const firestore = getFirestore(app);
                    setDb(firestore);

                    await signInAnonymously(auth);
                    onAuthStateChanged(auth, (u) => {
                        if (u) {
                            setUser(u);
                            setFirebaseInitialized(true);
                            setShowConfigModal(false);
                        }
                    });
                } catch (e) {
                    if (e.code === 'app/duplicate-app') return;
                    alert("資料庫連線失敗: " + e.message);
                    setShowConfigModal(true);
                }
            };

            const handleSaveConfig = () => {
                try {
                    let cleanInput = configInput.trim();

                    // 1. 移除前面的變數宣告 (const x = )
                    if (cleanInput.includes("=")) {
                        cleanInput = cleanInput.substring(cleanInput.indexOf("=") + 1);
                    }

                    // 2. 移除結尾分號
                    cleanInput = cleanInput.trim();
                    if (cleanInput.endsWith(";")) {
                        cleanInput = cleanInput.slice(0, -1);
                    }

                    cleanInput = cleanInput.trim();

                    let config = null;

                    // 3. 嘗試萬能解析
                    try {
                        // 先試試看標準 JSON
                        config = JSON.parse(cleanInput);
                    } catch (jsonError) {
                        // 如果失敗，試試看 JavaScript 物件 (這能解決 key 沒有引號的問題)
                        try {
                            const fn = new Function(`return ${cleanInput}`);
                            config = fn();
                        } catch (jsError) {
                            throw new Error("無法解析");
                        }
                    }

                    if (!config || !config.apiKey) {
                        throw new Error("缺少 apiKey");
                    }

                    localStorage.setItem('kcis_firebase_config', JSON.stringify(config));
                    initFirebase(config);
                } catch (e) {
                    alert("設定碼格式無法辨識！\n\n沒關係，請您直接把 Firebase 上的整段：\nconst firebaseConfig = { ... };\n\n全部複製貼上即可，我們會自動處理！");
                }
            };

            const handleResetConfig = () => {
                if (confirm('確定要清除連線設定嗎？')) {
                    localStorage.removeItem('kcis_firebase_config');
                    window.location.reload();
                }
            };

            // 2. 資料監聽
            useEffect(() => {
                if (!user || !db) return;
                setLoading(true);

                const configRef = doc(db, 'artifacts', 'kcis-portfolio-v5', 'public', 'data', 'config', 'semester_settings');
                const unsubConfig = onSnapshot(configRef, (docSnap) => {
                    if (docSnap.exists()) {
                        const data = docSnap.data();
                        if (data.semesters?.length > 0) setSemesters(data.semesters);
                    }
                });

                const subjConfigRef = doc(db, 'artifacts', 'kcis-portfolio-v5', 'public', 'data', 'config', 'subject_settings');
                const unsubSubjConfig = onSnapshot(subjConfigRef, (docSnap) => {
                    if (docSnap.exists()) {
                        const data = docSnap.data();
                        if (data.subjects?.length > 0) setSubjects(data.subjects);
                    }
                });

                const diverseConfigRef = doc(db, 'artifacts', 'kcis-portfolio-v5', 'public', 'data', 'config', 'diverse_type_settings');
                const unsubDiverseConfig = onSnapshot(diverseConfigRef, (docSnap) => {
                    if (docSnap.exists()) {
                        const data = docSnap.data();
                        if (data.diverseTypes?.length > 0) setDiverseTypes(data.diverseTypes);
                    }
                });

                const dataCol = collection(db, 'artifacts', 'kcis-portfolio-v5', 'public', 'data', 'student_portfolios');
                const unsubData = onSnapshot(dataCol, (snapshot) => {
                    const fetchedData = {};
                    snapshot.docs.forEach(docSnap => {
                        const [sem, cls] = docSnap.id.split('_');
                        if (!fetchedData[sem]) fetchedData[sem] = [];
                        fetchedData[sem] = [...fetchedData[sem], ...(docSnap.data().students || [])];
                    });

                    setAllData(prev => {
                        return { ...prev, ...fetchedData };
                    });
                    setLoading(false);
                });

                return () => { unsubConfig(); unsubSubjConfig(); unsubDiverseConfig(); unsubData(); };
            }, [user, db]);

            useEffect(() => {
                if (!loading && allData) {
                    let needsUpdate = false;
                    const newData = { ...allData };

                    semesters.forEach(sem => {
                        if (!newData[sem]) newData[sem] = [];
                        CLASSES.forEach(cls => {
                            if (!newData[sem].some(s => s.class === cls)) {
                                const initial = Array.from({ length: 40 }, (_, i) => ({
                                    id: `${cls}${(i + 1).toString().padStart(2, '0')}`,
                                    name: `學生 ${i + 1}`,
                                    class: cls,
                                    courseDetails: [],
                                    diverseDetails: [],
                                    isFinalApproved: false,
                                    lastUpdate: new Date().toLocaleDateString()
                                }));
                                newData[sem] = [...newData[sem], ...initial];
                                needsUpdate = true;
                            }
                        });
                    });
                    if (needsUpdate) setAllData(newData);
                }
            }, [loading, semesters, currentSemester]);

            // 3. 核心功能
            const syncToCloud = async (semester, className, studentsInSem) => {
                if (!user || !db) return;
                try {
                    const docId = `${semester}_${className}`;
                    const docRef = doc(db, 'artifacts', 'kcis-portfolio-v5', 'public', 'data', 'student_portfolios', docId);
                    const classSpecificStudents = studentsInSem.filter(s => s.class === className);
                    await setDoc(docRef, { students: classSpecificStudents });
                } catch (err) { console.error(err); }
            };

            const handleSingleUpdate = (newStudentsInSem) => {
                setAllData(prev => ({ ...prev, [currentSemester]: newStudentsInSem }));
                syncToCloud(currentSemester, currentClass, newStudentsInSem);
            };

            const updateNamesAcrossAllSemesters = async (newStudentBaseList) => {
                setIsSaving(true);
                try {
                    const updatedAllData = { ...allData };
                    const syncPromises = [];
                    for (const sem of semesters) {
                        const semData = [...(allData[sem] || [])];
                        const otherClassData = semData.filter(s => s.class !== currentClass);
                        const updatedSemClassData = newStudentBaseList.map(baseInfo => {
                            const existing = semData.find(s => s.id === baseInfo.id);
                            return {
                                id: baseInfo.id,
                                name: baseInfo.name,
                                class: currentClass,
                                courseDetails: existing ? (existing.courseDetails || []) : [],
                                diverseDetails: existing ? (existing.diverseDetails || []) : [],
                                isFinalApproved: existing ? (existing.isFinalApproved || false) : false,
                                lastUpdate: new Date().toLocaleDateString()
                            };
                        });
                        updatedAllData[sem] = [...otherClassData, ...updatedSemClassData];
                        syncPromises.push(syncToCloud(sem, currentClass, updatedAllData[sem]));
                    }
                    await Promise.all(syncPromises);
                    setAllData(updatedAllData);
                    return true;
                } catch (error) { return false; } finally { setIsSaving(false); }
            };

            // 操作功能
            const handleAddStudent = async () => {
                setIsSaving(true);
                try {
                    const updatedAllData = { ...allData };
                    const syncPromises = [];
                    const currentClassStudents = (allData[currentSemester] || []).filter(s => s.class === currentClass);
                    let maxNum = 0;
                    currentClassStudents.forEach(s => {
                        const numPart = parseInt(s.id.replace(currentClass, ''));
                        if (!isNaN(numPart) && numPart > maxNum) maxNum = numPart;
                    });
                    const newId = `${currentClass}${(maxNum + 1).toString().padStart(2, '0')}`;
                    const newStudentTemplate = {
                        id: newId, name: "新學生", class: currentClass,
                        courseDetails: [], diverseDetails: [], isFinalApproved: false,
                        lastUpdate: new Date().toLocaleDateString()
                    };
                    for (const sem of semesters) {
                        const semData = [...(allData[sem] || [])];
                        if (!semData.find(s => s.id === newId)) {
                            semData.push(newStudentTemplate);
                            semData.sort((a, b) => a.id.localeCompare(b.id));
                            updatedAllData[sem] = semData;
                            syncPromises.push(syncToCloud(sem, currentClass, semData));
                        }
                    }
                    await Promise.all(syncPromises);
                    setAllData(updatedAllData);
                } catch (error) { console.error(error); } finally { setIsSaving(false); }
            };

            const handleDeleteStudent = async (studentId) => {
                if (!window.confirm("確定要刪除這位學生嗎？此操作將會刪除該生在「所有學期」的資料且無法復原。")) return;
                setIsSaving(true);
                try {
                    const updatedAllData = { ...allData };
                    const syncPromises = [];
                    for (const sem of semesters) {
                        const semData = [...(allData[sem] || [])];
                        const newSemData = semData.filter(s => s.id !== studentId);
                        updatedAllData[sem] = newSemData;
                        syncPromises.push(syncToCloud(sem, currentClass, newSemData));
                    }
                    await Promise.all(syncPromises);
                    setAllData(updatedAllData);
                } catch (error) { console.error(error); } finally { setIsSaving(false); }
            };

            const handleBatchImport = async () => {
                const lines = importText.split('\n').filter(l => l.trim().length > 0);
                if (lines.length === 0) { setIsImportModalOpen(false); return; }

                const newBaseList = lines.map((line, index) => {
                    const trimmed = line.trim();
                    const match = trimmed.match(/^(\d+)\s+(.+)$/);
                    let seatNoString = '';
                    let name = '';

                    if (match) {
                        seatNoString = match[1];
                        name = match[2].trim();
                    } else {
                        // Fallback: use index + 1
                        seatNoString = (index + 1).toString();
                        name = trimmed;
                    }

                    const seatNo = parseInt(seatNoString, 10);
                    return {
                        id: `${currentClass}${seatNo.toString().padStart(2, '0')}`,
                        name: name,
                        class: currentClass
                    };
                });

                if (await updateNamesAcrossAllSemesters(newBaseList)) {
                    setImportText('');
                    setIsImportModalOpen(false);
                }
            };

            // 科目/學期設定
            const saveSemesterConfig = async (newSemList) => {
                if (!user || !db) return;
                const configRef = doc(db, 'artifacts', 'kcis-portfolio-v5', 'public', 'data', 'config', 'semester_settings');
                await setDoc(configRef, { semesters: newSemList });
            };
            const addSemester = () => {
                if (!newSemInput.trim() || semesters.includes(newSemInput.trim())) return;
                saveSemesterConfig([...semesters, newSemInput.trim()].sort());
                setNewSemInput('');
            };
            const deleteSemester = (sem) => saveSemesterConfig(semesters.filter(s => s !== sem));

            const handleAddNewSubject = async () => {
                const newSubject = prompt("請輸入新課程名稱：");
                if (newSubject && newSubject.trim()) {
                    const trimmed = newSubject.trim();
                    if (!subjects.includes(trimmed)) {
                        const newSubjects = [...subjects, trimmed];
                        const ref = doc(db, 'artifacts', 'kcis-portfolio-v5', 'public', 'data', 'config', 'subject_settings');
                        await setDoc(ref, { subjects: newSubjects });
                    }
                }
            };
            const handleAddNewDiverseType = async () => {
                const newType = prompt("請輸入新多元表現項目名稱：");
                if (newType && newType.trim()) {
                    const trimmed = newType.trim();
                    if (!diverseTypes.includes(trimmed)) {
                        const newTypes = [...diverseTypes, trimmed];
                        const ref = doc(db, 'artifacts', 'kcis-portfolio-v5', 'public', 'data', 'config', 'diverse_type_settings');
                        await setDoc(ref, { diverseTypes: newTypes });
                    }
                }
            };

            const FEEDBACK_OPTIONS = ['排版優化', '圖檔不清楚', '字體太小', '內容需修正', '項目分類有誤', '語意不清'];

            // 項目操作
            const addItem = (studentId, listKey, itemData) => {
                const updated = allData[currentSemester].map(s => s.id === studentId ? { ...s, [listKey]: [...(s[listKey] || []), { id: Date.now(), ...itemData, status: 'pending', isChecked: false, feedback: '', goodFeedback: '' }] } : s);
                handleSingleUpdate(updated);
            };
            const setItemStatus = (studentId, listKey, itemId, status) => {
                const updated = allData[currentSemester].map(s => s.id === studentId ? { ...s, [listKey]: (s[listKey] || []).map(i => i.id === itemId ? { ...i, status } : i) } : s);
                handleSingleUpdate(updated);
            };
            const updateItemFeedback = (studentId, listKey, itemId, newFeedback) => {
                const updated = allData[currentSemester].map(s => s.id === studentId ? { ...s, [listKey]: (s[listKey] || []).map(i => i.id === itemId ? { ...i, feedback: newFeedback } : i) } : s);
                handleSingleUpdate(updated);
            };
            const appendFeedback = (studentId, listKey, itemId, text) => {
                const student = allData[currentSemester].find(s => s.id === studentId);
                if (!student) return;
                const item = (student[listKey] || []).find(i => i.id === itemId);
                if (!item) return;

                let current = item.feedback || '';
                if (current && !current.endsWith('，') && !current.endsWith('、') && !current.endsWith('\n')) {
                    current += '，';
                }
                const newFeedback = current + text;
                updateItemFeedback(studentId, listKey, itemId, newFeedback);
            };

            const PRAISE_OPTIONS = ['內容充實', '見解獨到', '圖文並茂', '架構完整', '反思深刻'];

            const updateItemGoodFeedback = (studentId, listKey, itemId, newFeedback) => {
                const updated = allData[currentSemester].map(s => s.id === studentId ? { ...s, [listKey]: (s[listKey] || []).map(i => i.id === itemId ? { ...i, goodFeedback: newFeedback } : i) } : s);
                handleSingleUpdate(updated);
            };
            const appendGoodFeedback = (studentId, listKey, itemId, text) => {
                const student = allData[currentSemester].find(s => s.id === studentId);
                const item = (student[listKey] || []).find(i => i.id === itemId);
                if (!item) return;

                let current = item.goodFeedback || '';
                if (current && !current.endsWith('，') && !current.endsWith('、') && !current.endsWith('\n')) {
                    current += '，';
                }
                const newFeedback = current + text;
                updateItemGoodFeedback(studentId, listKey, itemId, newFeedback);
            };

            const toggleItemCheck = (studentId, listKey, itemId) => {
                const updated = allData[currentSemester].map(s => s.id === studentId ? { ...s, [listKey]: (s[listKey] || []).map(i => i.id === itemId ? { ...i, isChecked: !i.isChecked } : i) } : s);
                handleSingleUpdate(updated);
            };
            const toggleFinalApproval = (studentId) => {
                const updated = allData[currentSemester].map(s => s.id === studentId ? { ...s, isFinalApproved: !s.isFinalApproved } : s);
                handleSingleUpdate(updated);
            };
            const updateSingleStudentName = (id, newName) => {
                const updatedClassData = (allData[currentSemester] || []).filter(s => s.class === currentClass).map(s => s.id === id ? { ...s, name: newName } : s);
                updateNamesAcrossAllSemesters(updatedClassData);
            };
            const deleteItem = (studentId, listKey, itemId) => {
                const updated = allData[currentSemester].map(s => s.id === studentId ? { ...s, [listKey]: (s[listKey] || []).filter(i => i.id !== itemId) } : s);
                handleSingleUpdate(updated);
            };

            // View 邏輯
            const getStudentStatus = (student) => {
                if (student.isFinalApproved) return 'approved';
                const hasError = (student.courseDetails || []).some(d => d.status === 'error') || (student.diverseDetails || []).some(d => d.status === 'error');
                if (hasError) return 'error';
                if ((student.courseDetails?.length || 0) >= 3 && (student.diverseDetails?.length || 0) >= 1) return 'completed';
                if ((student.courseDetails?.length || 0) === 0 && (student.diverseDetails?.length || 0) === 0) return 'empty';
                return 'pending';
            };
            const currentViewStudents = useMemo(() => {
                const list = (allData[currentSemester] || []).filter(s => s.class === currentClass);
                return list.filter(s => s.name.includes(searchTerm)).sort((a, b) => a.id.localeCompare(b.id));
            }, [allData, currentSemester, currentClass, searchTerm]);
            const stats = useMemo(() => {
                const students = (allData[currentSemester] || []).filter(s => s.class === currentClass);
                return {
                    total: students.length,
                    hasError: students.filter(s => getStudentStatus(s) === 'error').length,
                    completed: students.filter(s => getStudentStatus(s) === 'completed' || getStudentStatus(s) === 'approved').length
                };
            }, [allData, currentSemester, currentClass]);

            const getSubjectIndex = (allDetails, currentItem) => {
                const sameSubject = allDetails.filter(d => d.subject === currentItem.subject);
                const idx = sameSubject.findIndex(d => d.id === currentItem.id) + 1;
                return { idx, total: sameSubject.length };
            };
            const getDiverseTypeIndex = (allDetails, currentItem) => {
                const sameType = allDetails.filter(d => d.type === currentItem.type);
                const idx = sameType.findIndex(d => d.id === currentItem.id) + 1;
                return { idx, total: sameType.length };
            };

            // 備份與還原
            const handleBackupData = () => {
                const backupData = { version: "KCIS_V5", timestamp: new Date().toISOString(), semesters, subjects, diverseTypes, allData };
                const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(backupData));
                const a = document.createElement('a');
                a.href = dataStr; a.download = `KCIS_Backup_${new Date().toISOString().slice(0, 10)}.json`;
                document.body.appendChild(a); a.click(); a.remove();
            };
            const handleRestoreData = (e) => {
                const file = e.target.files[0];
                if (!file) return;
                const reader = new FileReader();
                reader.onload = async (e) => {
                    try {
                        setIsSaving(true);
                        const backup = JSON.parse(e.target.result);
                        if (backup.semesters) { await saveSemesterConfig(backup.semesters); }
                        if (backup.subjects) {
                            const ref = doc(db, 'artifacts', 'kcis-portfolio-v5', 'public', 'data', 'config', 'subject_settings');
                            await setDoc(ref, { subjects: backup.subjects });
                            setSubjects(backup.subjects);
                        }
                        if (backup.diverseTypes) {
                            const ref = doc(db, 'artifacts', 'kcis-portfolio-v5', 'public', 'data', 'config', 'diverse_type_settings');
                            await setDoc(ref, { diverseTypes: backup.diverseTypes });
                            setDiverseTypes(backup.diverseTypes);
                        }
                        const promises = [];
                        for (const sem of backup.semesters) {
                            if (backup.allData[sem]) {
                                for (const cls of CLASSES) {
                                    const stus = backup.allData[sem].filter(s => s.class === cls);
                                    if (stus.length) promises.push(syncToCloud(sem, cls, stus));
                                }
                            }
                        }
                        await Promise.all(promises);
                        alert("還原成功！");
                        setIsSemModalOpen(false);
                        window.location.reload();
                    } catch (err) { alert("還原失敗"); } finally { setIsSaving(false); }
                };
                reader.readAsText(file);
            };

            // 匯出報表
            const exportToCSV = () => {
                // 1. Gather ALL students from all classes
                let allStudents = [];
                CLASSES.forEach(cls => {
                    const studentsInClass = (allData[currentSemester] || []).filter(s => s.class === cls);
                    // Sort by ID
                    studentsInClass.sort((a, b) => a.id.localeCompare(b.id));
                    allStudents = allStudents.concat(studentsInClass);
                });

                // 2. Headers (Rename 學號 -> 序號)
                const headers = ["序號", "姓名", "班級", "學期", "本學期課程總數", "本學期多元總數"];
                if (isSecondSemester) headers.push("學年度勾選課程件數", "學年度勾選多元件數", "老師最終核定");
                headers.push("狀態提示", "錯誤明細", "修正建議", "優良註記");

                // 3. Rows
                const rows = allStudents.map(s => {
                    const status = getStudentStatus(s);
                    let label = status === 'approved' ? '已核定' : (status === 'error' ? '需修正' : (status === 'completed' ? '已達標' : '進行中'));
                    if (status === 'empty') label = '未上傳';
                    const err = [...(s.courseDetails || []).filter(d => d.status === 'error').map(d => `課程-${d.subject}`), ...(s.diverseDetails || []).filter(d => d.status === 'error').map(d => `多元-${d.type}`)].join("; ");
                    const fb = [...(s.courseDetails || []).filter(d => d.status === 'error' && d.feedback).map(d => `課程-${d.subject}:${d.feedback}`), ...(s.diverseDetails || []).filter(d => d.status === 'error' && d.feedback).map(d => `多元-${d.type}:${d.feedback}`)].join(" | ");
                    const goodFb = [...(s.courseDetails || []).filter(d => d.status === 'verified' && d.goodFeedback).map(d => `課程-${d.subject}:${d.goodFeedback}`), ...(s.diverseDetails || []).filter(d => d.status === 'verified' && d.goodFeedback).map(d => `多元-${d.type}:${d.goodFeedback}`)].join(" | ");

                    const row = [s.id, s.name, s.class, currentSemester, (s.courseDetails?.length || 0), (s.diverseDetails?.length || 0)];
                    if (isSecondSemester) {
                        const checkedCourse = (s.courseDetails || []).filter(i => i.isChecked).length;
                        const checkedDiverse = (s.diverseDetails || []).filter(i => i.isChecked).length;
                        row.push(checkedCourse, checkedDiverse, s.isFinalApproved ? 'V' : '');
                    }
                    row.push(label, err, fb, goodFb);
                    return row;
                });

                // 4. Statistics Summary
                const statsRows = [];
                statsRows.push(["", "", "", "", "", ""]); // Empty row
                statsRows.push(["--- 統計摘要 ---", "", "", "", "", ""]);
                statsRows.push(["班級", "總人數", "課程總件數", "課程參與率", "多元總件數", "多元參與率"]);

                CLASSES.forEach(cls => {
                    const students = (allData[currentSemester] || []).filter(s => s.class === cls);
                    const totalStudents = students.length || 1;
                    const courseCount = students.reduce((acc, s) => acc + (s.courseDetails?.length || 0), 0);
                    const coursePart = Math.round((students.filter(s => (s.courseDetails?.length || 0) > 0).length / totalStudents) * 100) + "%";
                    const diverseCount = students.reduce((acc, s) => acc + (s.diverseDetails?.length || 0), 0);
                    const diversePart = Math.round((students.filter(s => (s.diverseDetails?.length || 0) > 0).length / totalStudents) * 100) + "%";
                    statsRows.push([`${cls}班`, totalStudents, courseCount, coursePart, diverseCount, diversePart]);
                });

                let csv = "\uFEFF" + headers.join(",") + "\n" + rows.map(r => r.join(",")).join("\n") + "\n" + statsRows.map(r => r.join(",")).join("\n");
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement("a");
                link.href = URL.createObjectURL(blob);
                link.download = `KCISLK_All_Classes_Report_${currentSemester}.csv`;
                link.click();
            };

            // UI 渲染
            // ... (rest is same until render)

            // Render Helper for Feedback
            const renderFeedbackSection = (studentId, listKey, item) => {
                if (item.status !== 'error') return null;
                return React.createElement('div', { className: "mt-4 pt-4 border-t border-[#802050]/10 w-full animate-in" },
                    React.createElement('div', { className: "flex items-center gap-2 mb-3" },
                        React.createElement(AlertTriangle, { size: 14, className: "text-[#802050]" }),
                        React.createElement('span', { className: "text-xs font-black text-[#802050]" }, "修正建議：")
                    ),
                    React.createElement('div', { className: "flex flex-wrap gap-2 mb-3" },
                        FEEDBACK_OPTIONS.map(opt =>
                            React.createElement('button', {
                                key: opt,
                                onClick: () => appendFeedback(studentId, listKey, item.id, opt),
                                className: "px-3 py-1.5 bg-red-50 text-[#802050] text-[10px] font-bold rounded-lg border border-red-100 hover:bg-[#802050] hover:text-white transition-all"
                            }, opt)
                        )
                    ),
                    React.createElement('textarea', {
                        value: item.feedback || '',
                        onChange: (e) => updateItemFeedback(studentId, listKey, item.id, e.target.value),
                        placeholder: "請輸入具體修正建議...",
                        className: "w-full p-3 bg-red-50/50 border border-red-100 rounded-xl text-xs text-[#802050] focus:ring-2 focus:ring-[#802050]/20 focus:border-[#802050] outline-none transition-all placeholder:text-[#802050]/40",
                        rows: 2
                    })
                );
            };

            const renderPraiseSection = (studentId, listKey, item) => {
                if (item.status !== 'verified') return null;
                return React.createElement('div', { className: "mt-4 pt-4 border-t border-[#409090]/10 w-full animate-in" },
                    React.createElement('div', { className: "flex items-center gap-2 mb-3" },
                        React.createElement(Award, { size: 14, className: "text-[#409090]" }),
                        React.createElement('span', { className: "text-xs font-black text-[#409090]" }, "優良表現註記：")
                    ),
                    React.createElement('div', { className: "flex flex-wrap gap-2 mb-3" },
                        PRAISE_OPTIONS.map(opt =>
                            React.createElement('button', {
                                key: opt,
                                onClick: () => appendGoodFeedback(studentId, listKey, item.id, opt),
                                className: "px-3 py-1.5 bg-teal-50 text-[#409090] text-[10px] font-bold rounded-lg border border-teal-100 hover:bg-[#409090] hover:text-white transition-all"
                            }, opt)
                        )
                    ),
                    React.createElement('textarea', {
                        value: item.goodFeedback || '',
                        onChange: (e) => updateItemGoodFeedback(studentId, listKey, item.id, e.target.value),
                        placeholder: "請輸入優良表現具體說明...",
                        className: "w-full p-3 bg-teal-50/50 border border-teal-100 rounded-xl text-xs text-[#409090] focus:ring-2 focus:ring-[#409090]/20 focus:border-[#409090] outline-none transition-all placeholder:text-[#409090]/40",
                        rows: 2
                    })
                );
            };

            // ... inside Main Render



            // UI 渲染
            if (!firebaseInitialized || showConfigModal) {
                return React.createElement('div', { className: "min-h-screen flex flex-col items-center justify-center bg-slate-900 text-white p-6" },
                    React.createElement('div', { className: "max-w-lg w-full bg-slate-800 p-8 rounded-3xl shadow-2xl border border-slate-700" },
                        React.createElement('div', { className: "flex items-center gap-4 mb-6" },
                            React.createElement(ShieldCheck, { size: 40, className: "text-[#D4AF37]" }),
                            React.createElement('h1', { className: "text-2xl font-black" }, "系統初始化設定")
                        ),
                        React.createElement('p', { className: "text-slate-400 mb-6 text-sm leading-relaxed" },
                            "歡迎使用 KCISLK 學習歷程管理系統。請貼上 Firebase 設定碼以啟用雲端同步功能。"
                        ),
                        React.createElement('textarea', {
                            className: "w-full h-48 bg-slate-950 p-4 rounded-xl text-xs font-mono text-green-400 mb-6 focus:ring-2 focus:ring-[#D4AF37] outline-none",
                            placeholder: '請直接貼上 Firebase 提供的整段程式碼...\nconst firebaseConfig = { ... };',
                            value: configInput,
                            onChange: (e) => setConfigInput(e.target.value)
                        }),
                        React.createElement('button', {
                            onClick: handleSaveConfig,
                            className: "w-full py-4 bg-[#D4AF37] text-[#003366] font-black rounded-xl hover:bg-[#F4CF60] transition-all flex items-center justify-center gap-2"
                        }, React.createElement(Zap, { size: 20 }), "連線並啟動系統")
                    )
                );
            }

            if (loading) return React.createElement('div', { className: "min-h-screen flex flex-col items-center justify-center bg-slate-50" }, React.createElement(Loader2, { className: "w-16 h-16 text-[#003366] animate-spin mb-4" }), React.createElement('p', { className: "font-bold text-[#802050] tracking-widest uppercase text-sm" }, "KCISLK Academic Syncing..."));

            return React.createElement('div', { className: "min-h-screen bg-[#FDFDFD] text-slate-800 font-sans selection:bg-[#F4CF60]/50" },
                // Header
                React.createElement('header', { className: "relative shadow-2xl overflow-hidden border-b-4 border-[#D4AF37]" },
                    React.createElement('div', { className: "absolute inset-0 flex" }, React.createElement('div', { className: "w-1/2 bg-[#802050]" }), React.createElement('div', { className: "w-1/2 bg-[#003366]" })),
                    React.createElement('div', { className: "absolute inset-0 bg-black/10" }),
                    React.createElement('div', { className: "max-w-6xl mx-auto px-6 py-12 relative z-10 text-white" },
                        React.createElement('div', { className: "flex flex-col lg:flex-row justify-between items-start lg:items-center gap-8" },
                            React.createElement('div', { className: "space-y-4" },
                                React.createElement('div', { className: "flex items-center gap-4" },
                                    React.createElement('div', { className: "bg-white p-2.5 rounded-xl shadow-lg" }, React.createElement(ShieldCheck, { size: 32, className: "text-[#003366]" })),
                                    React.createElement('div', { className: "space-y-0.5" },
                                        React.createElement('div', { className: "flex items-center gap-2" },
                                            React.createElement('span', { className: "text-[10px] font-black tracking-[0.4em] text-[#F4CF60] uppercase" }, "Kang Chiao International School"),
                                            React.createElement('div', { className: "flex items-center gap-1.5 px-2 py-0.5 bg-white/10 rounded-full border border-white/20 cursor-pointer", onClick: handleResetConfig, title: "點擊可重設連線" },
                                                React.createElement('div', { className: `w-1.5 h-1.5 rounded-full ${isSaving ? 'bg-amber-400 animate-pulse' : 'bg-teal-400'}` }),
                                                React.createElement('span', { className: "text-[8px] font-black text-white/70 uppercase" }, isSaving ? 'Syncing...' : 'Connected')
                                            )
                                        ),
                                        React.createElement('h1', { className: "text-4xl font-black tracking-tight text-white" }, "學習歷程檔案管理系統")
                                    )
                                ),
                                React.createElement('div', { className: "flex flex-wrap items-center gap-2 pt-4" },
                                    semesters.map(sem => React.createElement('button', { key: sem, onClick: () => { setCurrentSemester(sem); setExpandedStudent(null); }, className: `px-5 py-2.5 rounded-xl text-xs font-black transition-all border-2 ${currentSemester === sem ? 'bg-[#D4AF37] text-white border-[#F4CF60] shadow-xl scale-105' : 'bg-black/20 text-white/70 border-white/10 hover:bg-black/40'}` }, sem)),
                                    React.createElement('button', { onClick: () => setIsSemModalOpen(true), className: "p-2.5 rounded-xl bg-[#F4CF60] text-[#802050] shadow-lg hover:scale-110 transition-all border-2 border-[#D4AF37]" }, React.createElement(Settings, { size: 20 }))
                                )
                            ),
                            React.createElement('div', { className: "flex gap-4" },
                                React.createElement('button', { onClick: () => setIsBackupModalOpen(true), className: "bg-white text-[#003366] px-5 py-4 rounded-2xl text-sm font-black shadow-xl flex items-center gap-2 hover:bg-slate-50 border-b-4 border-slate-200 active:border-0 transition-all" }, React.createElement(Cloud, { size: 20 }), "資料保全"),
                                React.createElement('button', { onClick: exportToCSV, className: "bg-[#D4AF37] text-white px-8 py-4 rounded-2xl text-sm font-black shadow-xl flex items-center gap-2 hover:bg-[#B48F27] border-b-4 border-[#B48F27] active:border-0 transition-all" }, React.createElement(FileSpreadsheet, { size: 20 }), "匯出報表")
                            )
                        )
                    )
                ),

                // Main Content
                React.createElement('div', { className: "max-w-6xl mx-auto px-6 -mt-10 relative z-20 pb-20" },
                    // Stats
                    React.createElement('div', { className: "grid grid-cols-1 md:grid-cols-3 gap-6 mb-10" },
                        React.createElement('div', { className: "bg-white p-7 rounded-3xl shadow-xl border border-slate-100 flex items-center gap-5" }, React.createElement('div', { className: "w-14 h-14 bg-slate-50 rounded-2xl flex items-center justify-center text-[#003366]" }, React.createElement(Users, { size: 28 })), React.createElement('div', {}, React.createElement('span', { className: "text-[10px] font-black text-slate-400 uppercase tracking-widest block mb-1" }, "班級總人數"), React.createElement('div', { className: "text-3xl font-black text-[#003366]" }, stats.total))),
                        React.createElement('div', { className: "bg-white p-7 rounded-3xl shadow-xl border-l-8 border-l-[#802050] flex items-center gap-5" }, React.createElement('div', { className: "w-14 h-14 bg-red-50 rounded-2xl flex items-center justify-center text-[#802050]" }, React.createElement(AlertCircle, { size: 28 })), React.createElement('div', {}, React.createElement('span', { className: "text-[10px] font-black text-[#802050] uppercase tracking-widest block mb-1" }, "標註需修正"), React.createElement('div', { className: "text-3xl font-black text-[#003366]" }, stats.hasError))),
                        React.createElement('div', { onClick: () => setIsStatsModalOpen(true), className: "bg-white p-7 rounded-3xl shadow-xl border-l-8 border-l-[#409090] flex items-center gap-5 cursor-pointer hover:scale-105 transition-transform group" }, React.createElement('div', { className: "w-14 h-14 bg-teal-50 rounded-2xl flex items-center justify-center text-[#409090] group-hover:bg-[#409090] group-hover:text-white transition-colors" }, React.createElement(BarChart3, { size: 28 })), React.createElement('div', {}, React.createElement('span', { className: "text-[10px] font-black text-[#409090] uppercase tracking-widest block mb-1" }, "成果上傳統計"), React.createElement('div', { className: "text-xl font-black text-[#003366] flex items-center gap-2" }, "View Data", React.createElement(ChevronRight, { size: 16 }))))
                    ),

                    // List
                    React.createElement('div', { className: "bg-white rounded-[2.5rem] shadow-2xl border border-slate-100 overflow-hidden" },
                        React.createElement('div', { className: "p-8 border-b border-slate-100 flex flex-col sm:flex-row gap-6 items-center justify-between" },
                            React.createElement('div', { className: "flex p-1.5 bg-slate-100 rounded-2xl" }, CLASSES.map(cls => React.createElement('button', { key: cls, onClick: () => { setCurrentClass(cls); setExpandedStudent(null); }, className: `px-14 py-3 rounded-xl text-sm font-black transition-all ${currentClass === cls ? 'bg-[#003366] text-white shadow-xl scale-105' : 'text-slate-400 hover:text-slate-600'}` }, cls + " 班"))),
                            React.createElement('div', { className: "flex items-center gap-3 w-full sm:w-auto" },
                                React.createElement('div', { className: "relative flex-1 sm:w-72" }, React.createElement(Search, { className: "absolute left-5 top-1/2 -translate-y-1/2 text-slate-300", size: 20 }), React.createElement('input', { type: "text", placeholder: "搜尋學生姓名...", className: "w-full pl-14 pr-6 py-4 bg-slate-50 border-none rounded-2xl text-sm focus:ring-4 focus:ring-[#003366]/5 transition-all font-bold text-[#003366]", value: searchTerm, onChange: (e) => setSearchTerm(e.target.value) })),
                                React.createElement('div', { className: "flex gap-2" },
                                    React.createElement('button', { onClick: () => setIsImportModalOpen(true), className: "bg-[#802050] text-white px-5 py-4 rounded-2xl text-sm font-black flex items-center gap-2 shadow-xl hover:bg-[#601538] transition-all" }, React.createElement(ClipboardList, { size: 20 }), "批次匯入"),
                                    isManageMode && React.createElement('button', { onClick: handleAddStudent, className: "bg-green-600 text-white px-5 py-4 rounded-2xl text-sm font-black flex items-center gap-2 shadow-xl hover:bg-green-700 transition-all" }, React.createElement(UserPlus, { size: 20 }), "新增"),
                                    React.createElement('button', { onClick: () => setIsManageMode(!isManageMode), disabled: isSaving, className: `flex items-center gap-2 px-5 py-4 rounded-2xl text-sm font-black transition-all shadow-xl ${isManageMode ? 'bg-[#D4AF37] text-white border-2 border-[#D4AF37] hover:bg-[#B48F27]' : 'bg-white text-[#003366] border-2 border-slate-200 hover:bg-slate-50'}` }, isSaving ? React.createElement(Loader2, { className: "animate-spin", size: 20 }) : React.createElement(Settings2, { size: 20 }), isManageMode ? '儲存名單' : '編輯名單')
                                )
                            )
                        ),
                        React.createElement('div', { className: "overflow-x-auto" },
                            React.createElement('table', { className: "w-full text-left" },
                                React.createElement('thead', {},
                                    React.createElement('tr', { className: "bg-slate-50/50 text-slate-400 text-[11px] uppercase tracking-widest font-black border-b" },
                                        React.createElement('th', { className: "px-4 py-6" }, "座號"),
                                        React.createElement('th', { className: "px-4 py-6" }, "學生姓名"),
                                        React.createElement('th', { className: "px-4 py-6 text-center" }, "課程成果"),
                                        React.createElement('th', { className: "px-4 py-6 text-center" }, "多元表現"),
                                        React.createElement('th', { className: "px-4 py-6" }, "檢核狀態"),
                                        React.createElement('th', { className: "px-4 py-6 text-right" }, isManageMode ? '刪除' : '詳情')
                                    )
                                ),
                                React.createElement('tbody', { className: "divide-y divide-slate-100" },
                                    currentViewStudents.map((student, index) => {
                                        const status = getStudentStatus(student);
                                        const isExpanded = expandedStudent === student.id;
                                        const cCount = (student.courseDetails || []).length;
                                        const dCount = (student.diverseDetails || []).length;
                                        const seatNo = student.id.replace(currentClass, '');
                                        return React.createElement(React.Fragment, { key: student.id },
                                            React.createElement('tr', { className: `student-summary-row group transition-all cursor-pointer ${isExpanded ? 'bg-[#FDF8F9]' : 'hover:bg-slate-50/50'}`, onClick: () => !isManageMode && setExpandedStudent(isExpanded ? null : student.id) },
                                                React.createElement('td', { className: "px-4 py-7 font-black text-[#003366] font-mono" }, seatNo),
                                                React.createElement('td', { className: "px-4 py-7" }, isManageMode ? React.createElement('input', { className: "font-black text-[#003366] border-2 border-slate-200 rounded-xl px-4 py-2.5 text-sm focus:border-[#802050] w-24 outline-none", value: student.name, onClick: (e) => e.stopPropagation(), onChange: (e) => updateSingleStudentName(student.id, e.target.value) }) : React.createElement('div', { className: "flex items-center gap-3" }, React.createElement('div', { className: "font-black text-[#003366] text-xl" }, student.name), student.isFinalApproved && React.createElement(Award, { size: 18, className: "text-[#D4AF37]" }))),
                                                React.createElement('td', { className: "px-4 py-7 text-center" }, React.createElement('span', { className: `text-2xl font-mono font-black transition-colors ${cCount >= 3 ? 'text-[#802050]' : (cCount > 0 ? 'text-slate-900' : 'text-slate-200')}` }, cCount)),
                                                React.createElement('td', { className: "px-4 py-7 text-center" }, React.createElement('span', { className: `text-2xl font-mono font-black transition-colors ${dCount > 0 ? 'text-[#003366]' : 'text-slate-200'}` }, dCount)),
                                                React.createElement('td', { className: "px-4 py-7" }, status === 'approved' ? React.createElement('div', { className: "inline-flex items-center gap-2 text-[#D4AF37] bg-amber-50 px-3 py-2 rounded-xl font-black text-[10px] border border-amber-200 shadow-sm" }, React.createElement(Award, { size: 16 }), " 已完成年度核定") : status === 'error' ? React.createElement('div', { className: "inline-flex items-center gap-2 text-[#802050] bg-red-50 px-3 py-2 rounded-xl font-black text-[10px] border border-red-100 animate-pulse" }, React.createElement(AlertTriangle, { size: 16 }), " 需修正檔案") : status === 'completed' ? React.createElement('div', { className: "inline-flex items-center gap-2 text-[#409090] bg-teal-50 px-3 py-2 rounded-xl font-black text-[10px] border border-teal-100" }, React.createElement(CheckCircle2, { size: 16 }), " 通過檢核") : React.createElement('span', { className: "text-slate-300 text-[10px] font-black uppercase ml-4" }, status === 'empty' ? 'Waiting' : 'Processing')),
                                                React.createElement('td', { className: "px-4 py-7 text-right" }, isManageMode ? React.createElement('button', { onClick: (e) => { e.stopPropagation(); handleDeleteStudent(student.id); }, className: "p-3 bg-red-50 text-red-500 rounded-xl hover:bg-red-500 hover:text-white transition-all" }, React.createElement(Trash2, { size: 20 })) : React.createElement('div', { className: `transition-transform duration-500 inline-block ${isExpanded ? 'rotate-180 text-[#802050]' : 'text-slate-200'}` }, React.createElement(ChevronDown, { size: 32 })))
                                            ),
                                            isExpanded && !isManageMode && React.createElement('tr', { className: "expanded-detail-row" },
                                                React.createElement('td', { colSpan: 6, className: "px-10 py-16 bg-[#FDFDFD] border-y-2 border-slate-100 shadow-inner" },
                                                    isSecondSemester && React.createElement('div', { className: "mb-12 bg-slate-50 border-2 border-slate-200 p-8 rounded-[2.5rem] shadow-sm" },
                                                        React.createElement('div', { className: "flex flex-col md:flex-row items-center justify-between gap-10" },
                                                            React.createElement('div', { className: "space-y-4 flex-1" },
                                                                React.createElement('h5', { className: "font-black text-[#003366] text-xl flex items-center gap-2" }, React.createElement(Award, { className: "text-[#D4AF37]" }), " 學年度結算核定"),
                                                                React.createElement('p', { className: "text-xs text-slate-400 font-bold" }, "請勾選學生確認提交的檔案，完成後點擊核定。")
                                                            ),
                                                            React.createElement('button', { onClick: () => toggleFinalApproval(student.id), className: `px-12 py-5 rounded-2xl font-black text-sm transition-all shadow-xl flex items-center gap-2 h-fit ${student.isFinalApproved ? 'bg-slate-200 text-slate-400 hover:bg-slate-300' : 'bg-[#D4AF37] text-white hover:bg-[#B48F27] scale-105'}` }, student.isFinalApproved ? React.createElement(X, { size: 20 }) : React.createElement(CheckCircle2, { size: 20 }), student.isFinalApproved ? '取消核定' : '老師最終核定')
                                                        )
                                                    ),
                                                    React.createElement('div', { className: "grid grid-cols-1 lg:grid-cols-2 gap-20" },
                                                        // Course
                                                        React.createElement('div', { className: "space-y-8" },
                                                            React.createElement('div', { className: "border-b-2 border-[#802050]/20 pb-4" }, React.createElement('h4', { className: "flex items-center gap-3 font-black text-[#802050] text-2xl tracking-tight" }, React.createElement('div', { className: "w-2 h-10 bg-[#802050] rounded-full" }), "課程學習成果")),
                                                            React.createElement('div', { className: "flex flex-wrap gap-2.5" },
                                                                subjects.map(sub => React.createElement('button', { key: sub, onClick: () => addItem(student.id, 'courseDetails', { subject: sub }), className: "px-4 py-2 bg-white border border-[#802050]/20 rounded-2xl text-[11px] font-black text-[#802050] hover:bg-[#802050] hover:text-white transition-all shadow-sm active:scale-95 flex items-center gap-2" }, React.createElement(Plus, { size: 14 }), sub)),
                                                                React.createElement('button', { onClick: handleAddNewSubject, className: "px-4 py-2 bg-slate-50 border-2 border-dashed border-[#802050]/40 rounded-2xl text-[11px] font-black text-[#802050] hover:bg-[#802050]/10 transition-all shadow-sm active:scale-95 flex items-center gap-2" }, React.createElement(Plus, { size: 14 }), "自訂")
                                                            ),
                                                            React.createElement('div', { className: "space-y-4" }, (student.courseDetails || []).map(item => {
                                                                const { idx, total } = getSubjectIndex(student.courseDetails, item);
                                                                return React.createElement('div', { key: item.id, className: `bg-white p-6 rounded-[1.5rem] border flex flex-col shadow-lg transition-all ${item.isChecked ? 'border-l-8 border-l-[#802050] border-[#802050]/30' : 'border-slate-200'}` },
                                                                    React.createElement('div', { className: "w-full flex items-center justify-between" },
                                                                        React.createElement('div', { className: "flex items-center gap-5" },
                                                                            isSecondSemester && React.createElement('button', { onClick: () => toggleItemCheck(student.id, 'courseDetails', item.id), className: `transition-all ${item.isChecked ? 'text-[#802050]' : 'text-slate-200 hover:text-slate-400'}` }, item.isChecked ? React.createElement(CheckSquare, { size: 28 }) : React.createElement(Square, { size: 28 })),
                                                                            React.createElement('div', { className: `w-14 h-14 rounded-2xl flex items-center justify-center font-black text-lg ${item.status === 'verified' ? 'bg-teal-50 text-[#409090]' : item.status === 'error' ? 'bg-red-50 text-[#802050]' : 'bg-slate-50 text-slate-400'}` }, item.subject[0]),
                                                                            React.createElement('div', {},
                                                                                React.createElement('div', { className: "flex items-center gap-2" },
                                                                                    React.createElement('span', { className: "font-black text-[#003366] block text-base tracking-tight" }, `${item.subject} 成果報告 ${total > 1 ? `#${idx}` : ''}`),
                                                                                    React.createElement('button', { onClick: () => addItem(student.id, 'courseDetails', { subject: item.subject }), className: "text-[10px] bg-slate-100 text-slate-400 px-2 py-1 rounded-lg hover:bg-[#802050] hover:text-white transition-colors flex items-center gap-1 ml-2", title: "新增一份此科目的成果" }, React.createElement(Plus, { size: 10 }), " 增加")
                                                                                )
                                                                            )
                                                                        ),
                                                                        React.createElement('div', { className: "flex items-center gap-2" },
                                                                            React.createElement('button', { onClick: () => setItemStatus(student.id, 'courseDetails', item.id, 'verified'), className: `p-3.5 rounded-2xl transition-all shadow-md ${item.status === 'verified' ? 'bg-[#409090] text-white' : 'bg-white text-slate-300 hover:text-[#409090]'}` }, React.createElement(Check, { size: 20 })),
                                                                            React.createElement('button', { onClick: () => setItemStatus(student.id, 'courseDetails', item.id, 'error'), className: `p-3.5 rounded-2xl transition-all shadow-md ${item.status === 'error' ? 'bg-[#802050] text-white' : 'bg-white text-slate-300 hover:text-[#802050]'}` }, React.createElement(AlertCircle, { size: 20 })),
                                                                            React.createElement('button', { onClick: () => deleteItem(student.id, 'courseDetails', item.id), className: "p-3.5 text-slate-200 hover:text-red-400 transition-colors" }, React.createElement(Trash2, { size: 20 }))
                                                                        )
                                                                    ),
                                                                    renderFeedbackSection(student.id, 'courseDetails', item),
                                                                    renderPraiseSection(student.id, 'courseDetails', item)
                                                                );
                                                            }))
                                                        ),
                                                        // Diverse
                                                        React.createElement('div', { className: "space-y-8" },
                                                            React.createElement('div', { className: "border-b-2 border-[#003366]/20 pb-4" }, React.createElement('h4', { className: "flex items-center gap-3 font-black text-[#003366] text-2xl tracking-tight" }, React.createElement('div', { className: "w-2 h-10 bg-[#003366] rounded-full" }), "多元表現項目")),
                                                            React.createElement('div', { className: "flex flex-wrap gap-2.5" },
                                                                diverseTypes.map(type => React.createElement('button', { key: type, onClick: () => addItem(student.id, 'diverseDetails', { type, title: `${type}紀錄` }), className: "px-4 py-2 bg-white border border-[#003366]/20 rounded-2xl text-[11px] font-black text-[#003366] hover:bg-[#003366] hover:text-white transition-all shadow-sm active:scale-95 flex items-center gap-2" }, React.createElement(Plus, { size: 14 }), type)),
                                                                React.createElement('button', { onClick: handleAddNewDiverseType, className: "px-4 py-2 bg-slate-50 border-2 border-dashed border-[#003366]/40 rounded-2xl text-[11px] font-black text-[#003366] hover:bg-[#003366]/10 transition-all shadow-sm active:scale-95 flex items-center gap-2" }, React.createElement(Plus, { size: 14 }), "自訂")
                                                            ),
                                                            React.createElement('div', { className: "space-y-4" }, (student.diverseDetails || []).map(item => {
                                                                const { idx, total } = getDiverseTypeIndex(student.diverseDetails, item);
                                                                return React.createElement('div', { key: item.id, className: `bg-white p-6 rounded-[1.5rem] border flex flex-col shadow-lg transition-all ${item.isChecked ? 'border-l-8 border-l-[#003366] border-[#003366]/30' : 'border-slate-200'}` },
                                                                    React.createElement('div', { className: "w-full flex items-center justify-between" },
                                                                        React.createElement('div', { className: "flex items-center gap-5" },
                                                                            isSecondSemester && React.createElement('button', { onClick: () => toggleItemCheck(student.id, 'diverseDetails', item.id), className: `transition-all ${item.isChecked ? 'text-[#003366]' : 'text-slate-200 hover:text-slate-400'}` }, item.isChecked ? React.createElement(CheckSquare, { size: 28 }) : React.createElement(Square, { size: 28 })),
                                                                            React.createElement('div', { className: "text-[10px] font-black text-[#D4AF37] bg-[#003366] px-3 py-2 rounded-xl border-2 border-[#D4AF37] uppercase tracking-tighter" }, item.type),
                                                                            React.createElement('div', {},
                                                                                React.createElement('div', { className: "flex items-center gap-2" },
                                                                                    React.createElement('span', { className: "font-black text-[#003366] text-base tracking-tight" }, `${item.title} ${total > 1 ? `#${idx}` : ''}`),
                                                                                    React.createElement('button', { onClick: () => addItem(student.id, 'diverseDetails', { type: item.type, title: `${item.type}紀錄` }), className: "text-[10px] bg-slate-100 text-slate-400 px-2 py-1 rounded-lg hover:bg-[#003366] hover:text-white transition-colors flex items-center gap-1 ml-2", title: "新增一份此項目的紀錄" }, React.createElement(Plus, { size: 10 }), " 增加")
                                                                                )
                                                                            )
                                                                        ),
                                                                        React.createElement('div', { className: "flex items-center gap-2" },
                                                                            React.createElement('button', { onClick: () => setItemStatus(student.id, 'diverseDetails', item.id, 'verified'), className: `p-3.5 rounded-2xl transition-all shadow-md ${item.status === 'verified' ? 'bg-[#409090] text-white' : 'bg-white text-slate-300 hover:text-[#409090]'}` }, React.createElement(Check, { size: 20 })),
                                                                            React.createElement('button', { onClick: () => setItemStatus(student.id, 'diverseDetails', item.id, 'error'), className: `p-3.5 rounded-2xl transition-all shadow-md ${item.status === 'error' ? 'bg-[#802050] text-white' : 'bg-white text-slate-300 hover:text-[#802050]'}` }, React.createElement(AlertCircle, { size: 20 })),
                                                                            React.createElement('button', { onClick: () => deleteItem(student.id, 'diverseDetails', item.id), className: "p-3.5 text-slate-200 hover:text-red-400" }, React.createElement(Trash2, { size: 20 }))
                                                                        )
                                                                    ),
                                                                    renderFeedbackSection(student.id, 'diverseDetails', item),
                                                                    renderPraiseSection(student.id, 'diverseDetails', item)
                                                                );
                                                            }))
                                                        ),
                                                        React.createElement('div', { className: "mt-12 bg-gradient-to-br from-[#003366] to-[#001122] p-8 rounded-[2.5rem] text-white shadow-2xl relative overflow-hidden" },
                                                            React.createElement('div', { className: "absolute top-0 right-0 w-32 h-32 bg-white/5 -mr-16 -mt-16 rounded-full" }),
                                                            React.createElement('div', { className: "flex items-center gap-3 mb-4" }, React.createElement(ShieldCheck, { size: 24, className: "text-[#F4CF60]" }), React.createElement('span', { className: "font-black uppercase text-xs tracking-[0.3em] text-[#F4CF60]" }, "Crest Policy Notice")),
                                                            React.createElement('p', { className: "text-[11px] leading-loose opacity-80 font-medium italic" }, "您的所有操作皆會即時同步儲存至雲端資料庫。")
                                                        )
                                                    )
                                                )
                                            )
                                        );
                                    })
                                )
                            )
                        )
                    ),

                    // Modals here...

                    isStatsModalOpen && React.createElement('div', { className: "fixed inset-0 bg-[#001122]/95 backdrop-blur-xl z-[70] flex items-center justify-center p-4 overflow-y-auto" },
                        React.createElement('div', { className: "bg-white w-full max-w-7xl rounded-[3rem] shadow-3xl overflow-hidden flex flex-col max-h-[92vh] border-4 border-[#003366]/50 animate-in fade-in zoom-in duration-300" },
                            React.createElement('div', { className: "p-8 border-b bg-slate-50 flex items-center justify-between shrink-0" },
                                React.createElement('div', { className: "flex items-center gap-4" },
                                    React.createElement(BarChart3, { size: 32, className: "text-[#003366]" }),
                                    React.createElement('div', {},
                                        React.createElement('h3', { className: "text-2xl font-black text-[#003366] tracking-tight" }, "學期成果數據統計"),
                                        React.createElement('p', { className: "text-[10px] text-slate-400 font-bold tracking-widest mt-1 uppercase" }, `Statistics Overview - ${currentSemester}`)
                                    )
                                ),
                                React.createElement('button', { onClick: () => setIsStatsModalOpen(false), className: "p-3 text-slate-400 hover:bg-slate-200 rounded-full transition-all" }, React.createElement(X, { size: 32 }))
                            ),
                            React.createElement('div', { className: "p-8 overflow-y-auto flex-1 bg-[#F8FAFC]" },
                                React.createElement('div', { className: "grid grid-cols-1 lg:grid-cols-2 gap-8 h-full" },
                                    CLASSES.map(cls => {
                                        const students = (allData[currentSemester] || []).filter(s => s.class === cls);
                                        const totalStudents = students.length || 1; // avoid division by zero

                                        // Course Stats
                                        const diverseCount = students.reduce((acc, s) => acc + (s.diverseDetails?.length || 0), 0);
                                        const diverseStudentCount = students.filter(s => (s.diverseDetails?.length || 0) > 0).length;

                                        return React.createElement('div', { key: cls, className: "bg-white p-8 rounded-[2rem] shadow-xl border border-slate-100 flex flex-col gap-6" },
                                            React.createElement('div', { className: "flex items-center justify-between pb-4 border-b-2 border-slate-100" },
                                                React.createElement('h4', { className: "text-2xl font-black text-[#003366] flex items-center gap-3" },
                                                    React.createElement('span', { className: "bg-[#003366] text-white px-3 py-1 rounded-lg text-lg" }, cls), "班級統計"
                                                ),
                                                React.createElement('div', { className: "text-xs font-bold text-slate-400 bg-slate-100 px-3 py-1 rounded-full" }, `總人數: ${students.length}人`)
                                            ),

                                            // Diverse Block (Top Summary)
                                            React.createElement('div', { className: "bg-gradient-to-r from-[#003366] to-[#004488] p-6 rounded-2xl text-white shadow-lg relative overflow-hidden" },
                                                React.createElement(Award, { className: "absolute -right-4 -bottom-4 text-white/10 w-32 h-32" }),
                                                React.createElement('div', { className: "relative z-10" },
                                                    React.createElement('h5', { className: "text-sm font-black text-[#F4CF60] uppercase tracking-widest mb-4" }, "多元表現總覽"),
                                                    React.createElement('div', { className: "flex justify-between items-end" },
                                                        React.createElement('div', {},
                                                            React.createElement('div', { className: "text-4xl font-black mb-1" }, diverseCount),
                                                            React.createElement('div', { className: "text-[10px] opacity-70" }, "總上傳件數")
                                                        ),
                                                        React.createElement('div', { className: "text-right" },
                                                            React.createElement('div', { className: "text-2xl font-black text-[#40E0D0]" }, `${Math.round((diverseStudentCount / totalStudents) * 100)}%`),
                                                            React.createElement('div', { className: "text-[10px] opacity-70" }, `參與率 (${diverseStudentCount}/${totalStudents})`)
                                                        )
                                                    )
                                                )
                                            ),

                                            // Course Summary Block
                                            React.createElement('div', { className: "bg-gradient-to-r from-[#802050] to-[#A03060] p-6 rounded-2xl text-white shadow-lg relative overflow-hidden" },
                                                React.createElement(BookOpen, { className: "absolute -right-4 -bottom-4 text-white/10 w-32 h-32" }),
                                                React.createElement('div', { className: "relative z-10" },
                                                    React.createElement('h5', { className: "text-sm font-black text-[#FFD700] uppercase tracking-widest mb-4" }, "課程學習成果總覽"),
                                                    React.createElement('div', { className: "flex justify-between items-end" },
                                                        React.createElement('div', {},
                                                            React.createElement('div', { className: "text-4xl font-black mb-1" },
                                                                students.reduce((acc, s) => acc + (s.courseDetails?.length || 0), 0)
                                                            ),
                                                            React.createElement('div', { className: "text-[10px] opacity-70" }, "總上傳件數")
                                                        ),
                                                        React.createElement('div', { className: "text-right" },
                                                            React.createElement('div', { className: "text-2xl font-black text-[#FFB6C1]" },
                                                                `${Math.round((students.filter(s => (s.courseDetails?.length || 0) > 0).length / totalStudents) * 100)}%`
                                                            ),
                                                            React.createElement('div', { className: "text-[10px] opacity-70" }, `參與率 (${students.filter(s => (s.courseDetails?.length || 0) > 0).length}/${totalStudents})`)
                                                        )
                                                    )
                                                )
                                            ),

                                            // Course Table
                                            React.createElement('div', { className: "flex-1 overflow-hidden flex flex-col" },
                                                React.createElement('h5', { className: "text-sm font-black text-[#802050] uppercase tracking-widest mb-4 flex items-center gap-2" }, React.createElement(BookOpen, { size: 16 }), "課程學習成果細項"),
                                                React.createElement('div', { className: "overflow-y-auto custom-scrollbar flex-1 pr-2" },
                                                    React.createElement('table', { className: "w-full text-left" },
                                                        React.createElement('thead', {},
                                                            React.createElement('tr', { className: "text-[10px] text-slate-400 border-b border-slate-100" },
                                                                React.createElement('th', { className: "pb-2 pl-2" }, "科目"),
                                                                React.createElement('th', { className: "pb-2 text-center" }, "件數"),
                                                                React.createElement('th', { className: "pb-2 text-right pr-2" }, "參與率")
                                                            )
                                                        ),
                                                        React.createElement('tbody', { className: "divide-y divide-slate-50" },
                                                            subjects.map(sub => {
                                                                const count = students.reduce((acc, s) => acc + (s.courseDetails || []).filter(i => i.subject === sub).length, 0);
                                                                const stuCount = students.filter(s => (s.courseDetails || []).some(i => i.subject === sub)).length;
                                                                return React.createElement('tr', { key: sub, className: "hover:bg-slate-50 transition-colors" },
                                                                    React.createElement('td', { className: "py-3 pl-2 font-bold text-[#003366] text-sm" }, sub),
                                                                    React.createElement('td', { className: "py-3 text-center font-mono text-slate-600 font-bold" }, count),
                                                                    React.createElement('td', { className: "py-3 text-right pr-2" },
                                                                        React.createElement('div', { className: "flex items-center justify-end gap-2" },
                                                                            React.createElement('div', { className: "w-16 h-1.5 bg-slate-100 rounded-full overflow-hidden" },
                                                                                React.createElement('div', { className: "h-full bg-[#802050]", style: { width: `${(stuCount / totalStudents) * 100}%` } })
                                                                            ),
                                                                            React.createElement('span', { className: "text-xs font-bold text-[#802050]" }, `${Math.round((stuCount / totalStudents) * 100)}%`)
                                                                        )
                                                                    )
                                                                );
                                                            })
                                                        )
                                                    )
                                                )
                                            )
                                        );
                                    })
                                )
                            )
                        )
                    ),
                    isSemModalOpen && React.createElement('div', { className: "fixed inset-0 bg-[#001122]/90 backdrop-blur-xl z-[60] flex items-center justify-center p-4" },
                        React.createElement('div', { className: "bg-white w-full max-w-lg rounded-[3rem] shadow-3xl overflow-hidden flex flex-col border-4 border-[#F4CF60] my-auto" },
                            React.createElement('div', { className: "p-10 border-b bg-slate-50 flex items-center justify-between shrink-0" }, React.createElement('h3', { className: "text-2xl font-black text-[#003366]" }, "系統設定與資料備份"), React.createElement('button', { onClick: () => setIsSemModalOpen(false), className: "p-3 text-slate-400 hover:bg-slate-200 rounded-full transition-all" }, React.createElement(X, { size: 32 }))),
                            React.createElement('div', { className: "p-10 space-y-10 overflow-y-auto max-h-[70vh] custom-scrollbar" },
                                React.createElement('div', { className: "space-y-6" },
                                    React.createElement('div', { className: "flex items-center gap-2 text-[#003366] font-black uppercase tracking-widest text-sm" }, React.createElement(Settings, { size: 16 }), " 學期清單管理"),
                                    React.createElement('div', { className: "flex gap-3" }, React.createElement('input', { className: "flex-1 bg-slate-100 border-none rounded-2xl px-5 py-4 text-sm font-bold text-[#003366] focus:ring-4 focus:ring-[#003366]/5 outline-none", placeholder: "輸入學期 (如: 117-1)", value: newSemInput, onChange: (e) => setNewSemInput(e.target.value) }), React.createElement('button', { onClick: addSemester, className: "bg-[#003366] text-white px-6 py-4 rounded-2xl font-black shadow-lg hover:bg-[#004488] transition-all flex items-center gap-2" }, React.createElement(Plus, { size: 20 }), "新增")),
                                    React.createElement('div', { className: "space-y-3 max-h-48 overflow-y-auto pr-2 custom-scrollbar" }, semesters.map(sem => React.createElement('div', { key: sem, className: "flex items-center justify-between bg-slate-50 p-4 rounded-2xl border border-slate-100" }, React.createElement('span', { className: "font-black text-[#003366]" }, sem), React.createElement('button', { onClick: () => deleteSemester(sem), className: "p-2 text-slate-300 hover:text-red-500 transition-colors" }, React.createElement(Trash2, { size: 20 })))))
                                ),
                            )
                        )
                    ),

                    isBackupModalOpen && React.createElement('div', { className: "fixed inset-0 bg-[#001122]/90 backdrop-blur-xl z-[60] flex items-center justify-center p-4" },
                        React.createElement('div', { className: "bg-white w-full max-w-lg rounded-[3rem] shadow-3xl overflow-hidden flex flex-col border-4 border-[#409090] my-auto animate-in fade-in zoom-in duration-300" },
                            React.createElement('div', { className: "p-10 border-b bg-slate-50 flex items-center justify-between shrink-0" }, React.createElement('h3', { className: "text-2xl font-black text-[#003366]" }, "系統資料保全"), React.createElement('button', { onClick: () => setIsBackupModalOpen(false), className: "p-3 text-slate-400 hover:bg-slate-200 rounded-full transition-all" }, React.createElement(X, { size: 32 }))),
                            React.createElement('div', { className: "p-10 space-y-6" },
                                React.createElement('div', { className: "bg-slate-50 p-6 rounded-2xl border border-slate-100 space-y-4" },
                                    React.createElement('p', { className: "text-xs text-slate-400 font-bold leading-relaxed" }, "建議定期下載備份。若發生資料遺失或需要轉移裝置，可使用還原功能。"),
                                    React.createElement('button', { onClick: handleBackupData, className: "w-full py-4 bg-emerald-500 text-white rounded-2xl font-black shadow-lg hover:bg-emerald-600 transition-all flex items-center justify-center gap-2" }, React.createElement(FileJson, { size: 20 }), " 下載完整備份檔案 (.json)"),
                                    React.createElement('div', { className: "relative" },
                                        React.createElement('input', { type: "file", accept: ".json", onChange: handleRestoreData, ref: fileInputRef, className: "absolute inset-0 w-full h-full opacity-0 cursor-pointer" }),
                                        React.createElement('button', { className: "w-full py-4 bg-white text-[#D4AF37] border-2 border-[#D4AF37] rounded-2xl font-black shadow-sm hover:bg-[#D4AF37] hover:text-white transition-all flex items-center justify-center gap-2" }, React.createElement(Upload, { size: 20 }), " 匯入備份還原資料")
                                    )
                                )
                            )
                        )
                    ),

                    isImportModalOpen && React.createElement('div', { className: "fixed inset-0 bg-[#001122]/85 backdrop-blur-xl z-50 flex items-center justify-center p-4 overflow-y-auto" },
                        React.createElement('div', { className: "bg-white w-full max-w-2xl rounded-[3rem] shadow-3xl overflow-hidden flex flex-col max-h-[92vh] animate-in fade-in zoom-in duration-300 border-4 border-[#D4AF37]/30" },
                            React.createElement('div', { className: "p-10 border-b bg-slate-50 flex items-center justify-between shrink-0" },
                                React.createElement('div', { className: "flex items-center gap-4" }, React.createElement(ShieldCheck, { size: 32, className: "text-[#003366]" }), React.createElement('div', {}, React.createElement('h3', { className: "text-2xl font-black text-[#003366] tracking-tight" }, "批次匯入學員名冊"), React.createElement('p', { className: "text-[9px] text-slate-400 font-bold tracking-[0.2em] mt-1 uppercase" }, "Kang Chiao Global Student Sync"))),
                                React.createElement('button', { onClick: () => setIsImportModalOpen(false), className: "p-3 text-slate-400 hover:bg-slate-200 rounded-full transition-all" }, React.createElement(X, { size: 32 }))
                            ),
                            React.createElement('div', { className: "p-10 space-y-8 overflow-y-auto flex-1" },
                                React.createElement('div', { className: "bg-[#003366] p-6 rounded-[2rem] flex items-center gap-5 text-white border-l-8 border-l-[#D4AF37]" }, React.createElement(ClipboardList, { size: 32, className: "text-[#F4CF60]" }), React.createElement('p', { className: "text-[13px] font-bold leading-relaxed" }, "同步到每學期。完成後將即時儲存並返回主畫面。")),
                                React.createElement('textarea', { className: "w-full h-80 p-8 bg-slate-50 border-2 border-slate-100 rounded-[2rem] text-sm focus:border-[#D4AF37] transition-all resize-none font-black text-[#003366] outline-none", placeholder: "一行一位姓名...", value: importText, onChange: (e) => setImportText(e.target.value) })
                            ),
                            React.createElement('div', { className: "p-10 border-t bg-slate-50 shrink-0" },
                                React.createElement('div', { className: "flex gap-5" },
                                    React.createElement('button', { onClick: () => { setIsImportModalOpen(false); setImportText(''); }, className: "flex-1 py-5 text-slate-400 font-black hover:text-slate-600 bg-white border-2 border-slate-200 rounded-[1.5rem]" }, "取消"),
                                    React.createElement('button', { onClick: handleBatchImport, disabled: !importText.trim() || isSaving, className: "flex-[2] py-5 bg-[#D4AF37] text-white rounded-[1.5rem] font-black shadow-2xl disabled:opacity-50 hover:bg-[#B48F27] transition-all flex items-center justify-center gap-3 active:translate-y-1" }, isSaving ? React.createElement(Loader2, { className: "animate-spin", size: 24 }) : React.createElement(CheckCircle2, { size: 24 }), "確定匯入")
                                )
                            )
                        )
                    )
                ),
                React.createElement('footer', { className: "max-w-6xl mx-auto px-6 py-12 flex flex-col md:flex-row items-center justify-between text-slate-400 text-[10px] font-black uppercase tracking-[0.5em] gap-8 border-t mt-12" },
                    React.createElement('div', { className: "flex items-center gap-6" }, React.createElement('span', { className: "text-[#003366]" }, "KCIS LK Academic Portal"), React.createElement('span', {}, "Crest Edition 9.4")),
                    React.createElement('div', { className: "flex gap-10" }, React.createElement('span', {}, "Encrypted Database Sync"), React.createElement('span', { className: "underline italic lowercase" }, "Academic Management Software"))
                )
            );
        };
        // --- 元件結束 ---

        const root = createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>

</html>